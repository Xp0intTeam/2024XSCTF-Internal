* **题目名称：** Leak_RSA

* **题目类型：** CRYPTO

* **题目难度：** (简单)

* **出题人：** HvAng

* **考点：**  

1. 素因子泄露

* **描述：**  没给我n啊，这咋办？

* **flag：** XSCTF{W0w_it_1s_5o_D@nger0u5:(((((((}

* **Writeup：**

`n`的因子之间相互取模，根据大小关系，必然会泄露出其中一个素因子
没有`n`的情况下，知道其中一个因子也能求解，因为$m^{e}=k*n+c$，假设这里我们知道的是`p`，两边同时取模于`p`，则$c\equiv m^{e}(mod\ p)$，之后与常规`RSA`解法相同

```py
from Crypto.Util.number import *

e = 65537
leak1 = 2788739042668918537941781531724930574560005691121074831614857609917360160482700410116314943550387670482209092849226979390003571693127462185448034388680568
leak2 = 1052794395433672774454602395629995702193825831811400985762346901401999360606415037009545828920475617009855752205214042043479772898002629658076401605342018
leak3 = 7178714483870123715329052119057202517870454611331910581547053172963141530711926115642776608592175083777507121192881454193293730845435637902528497680051043
c = 303207585959722091416888808302303902759477684186954246223344979954007378835147589414208072138404930371953334434739192265255311036731277242107515329324189302764042194164008395935037239784625015486597798565328123538179429396419895747859613808210181827498987744262520224633169713938847935438891255378204804566253453898965842923619704512096373657005536406487415372176995820296769776695235744090580931067205646422943522138917478058553286338836261701729201311710741570
leak = [leak1, leak2, leak3]
for i in leak:
    if GCD(e, i-1) == 1:
        d = inverse(e, i-1)
        flag = long_to_bytes(pow(c, d, i))
        if b'XSCTF' in flag:
            print(flag.decode())
```