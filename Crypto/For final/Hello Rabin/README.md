* **题目名称：** Hello Rabin

* **题目类型：** CRYPTO
* **题目难度：** (简单)

* **出题人：** HvAng

* **考点：**  

1. Rabin密码体制

* **描述：**  RSA? RAbin's RSA!

* **flag：** XSCTF{l3@rn_s0m3ThiNg_m0re_AbOut_RSA}

* **Writeup：**

先通过解方程得出pq的值
接下来介绍`Rabin密码体制`
`pq`的选择为$p\equiv 3(mod\ 4) ，q\equiv 3(mod\ 4)$
加密过程为$c\equiv m^{2}(mod\ n)$，本题可视为加密10次
解密过程，不再阐述，具体见
<https://jayxv.github.io/2019/12/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%95%B0%E8%AE%BA%E5%9B%9B%E5%A4%A7%E5%AE%9A%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8/>
应用：Rabin算法

涉及到了，费马小定理、二次剩余、中国剩余定理等的数论知识

```py
from Crypto.Util.number import *
from sympy import *
n = 123770464722879875846147528771569352938523105874170300409698797683747065712342412852753983919607247435286831826829154246631594440438265991968052833136054609782019415414359689344338765339538186089578881299308829109038556899321052446424489915629599789771281810924457818696680210413736875796916662846753611927137
c = 937987357738463548341772032357099967238536447336710171468629143230825950984798822063933743987627939764489626527758496426279640526380007252841212548571135543249543948520210341525909244307513053998652463075539181346428246147649057840441386462983315704583655218511095470636987143707392959236332237163787646178
leak = 22609797967850100595840516802887667449397587172251760038253766792312875206678099225977476589847795843516981573514959390823230936887101624955018947945421518
p, q = symbols('p q')
res = solve([n-p*q, leak-p-q], [p, q])
p, q = res[1]
p = int(p)
q = int(q)
inv_p = inverse(p, q)
inv_q = inverse(q, p)
cs = [c]
for i in range(10):
    ps = []
    for c in cs:
        r = pow(c, (p + 1) // 4, p)
        s = pow(c, (q + 1) // 4, q)
        x = (r*inv_q*q + s * inv_p * p) % n
        y = (r*inv_q*q - s * inv_p * p) % n
        if x not in ps:
            ps.append(x)
        if n - x not in ps:
            ps.append(n - x)
        if y not in ps:
            ps.append(y)
        if n - y not in ps:
            ps.append(n - y)
    cs = ps  # 嵌套
for m in ps:
    flag = long_to_bytes(m)
    if b'XSCTF' in flag:
        print(flag.decode())
```
