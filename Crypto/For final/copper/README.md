* **题目名称：** copper

* **题目类型：** CRYPTO
* **题目难度：** (中等)

* **出题人：** HvAng

* **考点：**  

1. 明文高低位泄露+低加密指数

* **描述：**  什么是铜？

* **flag：** XSCTF{c0pp3r5mith_@tt4ck_1s_50_us3fulll}

* **Writeup：**

打明文的高低位泄露，原理不过多解释，可自行查阅`coppersmith attack`，过程都在`exp`中，位数需要自己计算把握好

```py
# sage
from sage.all import *
from Crypto.Util.number import *

n = 163713708536150433334748394945952052598887443360588221620935711098313230858481819815762716558141920998155930301215406645488452384866101815018756425688395373694367412328887861439962674489361976529132219490425492006793192070243595267219377631574676372784387139755565859899507999758204451067077160381655976827527
c = 108040437802058042027241539950241756219931253814088035427392841452317977578342532030837630322797962163455533492871168885290758385982863280002064022657917263385824360447103772924472904586373988400686721852334965207486329919161223392222193697930626969100073739638150209354733952020432624138746753047312754973124
m_high = bytes_to_long(b'copperXSCTF{')
m_low = bytes_to_long(b'}a_simple_problem')
R.< x > = PolynomialRing(Zmod(n))
f = ((m_high << 400)+x*2 ^ 136+m_low)^3-c
f = f.monic()
# 未知m中间的264位
roots = f.small_roots(X=2 ^ 264, beta=0.4,epsilon=0.02)
for root in roots:
    m = (m_high << 400)+int(root)*2 ^ 136+m_low
    print(long_to_bytes(int(m)).decode())
```
