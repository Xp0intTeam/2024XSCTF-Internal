* **题目名称：** Baby_mod

* **题目类型：** CRYPTO

* **题目难度：** (简单)

* **出题人：** HvAng

* **考点：**  

1. 丢番图方程求解

* **描述：**  希尔伯特的第十个问题

* **flag：** XSCTF{Di0ph@ntin3_Equ4tIon_i5_s0_Funny:D}

* **Writeup：**

`丢番图方程`，$pr-qs=leak-t$与$ax+by=c$形式一致，只要$GCD(a,b)=d|c$，则方程有解
其实这里也没有太复杂，就是取模和取整两个操作即可得到`p,q`
$p*r=(leak-r)+q*s$，两边同时取模`s`，并乘上`r`在模`s`(二者互素)下的逆元，即可得到`p`
$q*s=p*r-(leak-t)$，整除`s`，即可得到`q`
因为要爆破参数`t`，所以要注意`q`的正负号

```py
from Crypto.Util.number import *
from tqdm import *

# flag = b'XSCTF{Di0ph@ntin3_Equ4tIon_i5_s0_Funny:D}'
c = 8974862970974067747036130912778497189286015047455461723548338216071398526364092915357066347522912763259645527945964820752708582834713838572361598416992355369540775133998215538169036328380048968066595283182567486501842664486403210648396873113294001442671142286467750543591821265613564146130872866542511060063
leak = -22224149994648923268789165509278165317007019455022228125461360264793582171180635864579051464573337703687603580778495942125972142098772460556824154925867963032811028915392488366933631534188006255843741792247909707811296603266184677505976551213494692490958051692640473222958630333160094121388820523562777011757770463239266929437423460046580341706128217879344508078081919107
r = 3713559774641553436276209941711693805945428824832652977855633547840173231986353608653241781778848123547004971784830459033920945156217927983674366335721583894756256542949490248528661744237220067
s = 3253961557665053735006933248952708348480142618850029234835814776973317490037893238569932660577366140882645494681486024928968833274980657993492577660282073430006337665469597700457553957032764444206539094923833498222709
e = 65537
for t in tqdm(range(2**14, 2**15)):
    p = (leak-t)*inverse(r, s) % s
    q = (p*r-(leak-t))//s
    if q > 0:
        n = p*q
        if GCD(e, (p-1)*(q-1)) == 1:
            d = inverse(e, (p-1)*(q-1))
            flag = long_to_bytes(pow(c, d, n))
            if b'XSCTF{' in flag:
                print(flag)
                break
```
