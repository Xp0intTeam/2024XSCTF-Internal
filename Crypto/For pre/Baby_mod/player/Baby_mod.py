from Crypto.Util.number import *
from secret import flag

m = bytes_to_long(flag)
p = getPrime(512)
q = getPrime(512)
r = getPrime(640)
s = getPrime(720)
t = getPrime(15)

e = 65537
n = p*q
assert GCD(e, (p-1)*(q-1)) == 1
print(f"c = {pow(m,e,n)}")
print(f"leak = {p*r-q*s+t}")
print(f"r = {r}")
print(f"s = {s}")
"""
c = 8974862970974067747036130912778497189286015047455461723548338216071398526364092915357066347522912763259645527945964820752708582834713838572361598416992355369540775133998215538169036328380048968066595283182567486501842664486403210648396873113294001442671142286467750543591821265613564146130872866542511060063
leak = -22224149994648923268789165509278165317007019455022228125461360264793582171180635864579051464573337703687603580778495942125972142098772460556824154925867963032811028915392488366933631534188006255843741792247909707811296603266184677505976551213494692490958051692640473222958630333160094121388820523562777011757770463239266929437423460046580341706128217879344508078081919107
r = 3713559774641553436276209941711693805945428824832652977855633547840173231986353608653241781778848123547004971784830459033920945156217927983674366335721583894756256542949490248528661744237220067
s = 3253961557665053735006933248952708348480142618850029234835814776973317490037893238569932660577366140882645494681486024928968833274980657993492577660282073430006337665469597700457553957032764444206539094923833498222709
"""
