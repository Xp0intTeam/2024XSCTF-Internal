* **题目名称：** Little Lattice

* **题目类型：** CRYPTO
* **题目难度：** (简单)

* **出题人：** HvAng

* **考点：**  

1. 简单格构造

* **描述：**  Life Love Learn……

* **flag：** XSCTF{L@t7icE_reduction_Mag1c_@nd_SVP}

* **Writeup：**

$h=g*m^{-1}(mod\ p)$       
$g=k*p+m*h$       
$构造格$       
$$
\left [ \begin{matrix}
k&m\\
\end{matrix} \right ] 
*
\left [ \begin{matrix}
p&0\\
h&1\\
\end{matrix} \right ] 
\ =
\left [ \begin{matrix}
g&m\\
\end{matrix} \right ]
$$       
$利用LLL算法求解，这是一个mini版的NTRU$       
<https://hasegawaazusa.github.io/NTRU-note.html>

```py
# sage
from Crypto.Util.number import *
p = 170001504821679400408838857023927771322082274766403596713170037337952358142085809362137716645386091939739140694131811367337416674339592709204262504837554237408172271147917362836615734660153454383522727225908429521633965668558304703644330007360133181361488530248482438791497679333699617299771790093625182495583
h = 146445935561313386592198795479451079790243126189420469491200810536866325122129230670920203734176865543158958625162496332264488625136774699408751960945772441095106215386241962809994620717853182692511768215561490346910591775678279534786015761634206120312045278049231012641280332773800801842956823948947329501702
mat = [[p, 0], [h, 1]]
M = Matrix(ZZ, mat)
g, m = M.LLL()[0]
flag = long_to_bytes(abs(m)).decode()
print(flag)
```
