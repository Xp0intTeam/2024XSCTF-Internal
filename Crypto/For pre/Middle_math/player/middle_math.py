import numpy as np
from Crypto.Util.number import *
from secret import flag

a, b, c, d = [getPrime(128) for _ in range(4)]
point1 = a * d
point2 = b * c
matrix2 = [[0, a, b], [0, c, d]]
flag = bytes_to_long(flag)


def randomArray():
    upper = [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
    low = [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
    for i in range(3):
        for j in range(i+1, 3):
            upper[i][j] = getPrime(128)
            low[j][i] = getPrime(128)
    result = np.array(upper) @ np.array(low)
    return result


A = np.array([[flag, 0, 0]] + matrix2)
B = randomArray()
C = randomArray()
MAT = C @ A @ B

print(point1)
print(point2)
print(MAT)
"""
84398296377673387974394799481037004942453792215867750016302914914041375345973
96191657337986293413741134416604284625332325559202048835251798484931595167377
[[18769241376891579938613512226319031206069388916505284593295962928079174367574224147305020451875825137166973316807700129850041730434853831763172062116757550150362865224079909649781134108539214006566824020963326163396631758268382041359631259992862482673692021676728001414981048
  10161163833094007560548215070938671837286333853010085298483729672033009218989813486765768028047723645863832974488690902359457458286779234814676974953361873686336384603078385929696652345529996781451987691305059775000396441082215296032774771934079197539065209768829790775572453
  40536954800473259834968641964250799923237997668194096772704185650691022804799926935104004168706908848697334614087692808583149408950228659133948030799453808051366891641274516127768355714763325919480822477671889967663793552591232791833611]
 [5982577155420877042669969668134230414669477973229294914250230347329184648717707387030727153432099649389072788475173504727347039653995324674159518048372934267832789009472364331085548490266063576515637686766091106218622583412372940988365101090884105286273475622896203081121181
  3238806800961106037965674308441126576486274931644168893954447613880834426116849967909998055363968735679475164129438669170878823658493401264518437836601929048214589138659542376546066653360796659959420263116504441800214227965272724187982913010969947189439456341724249273179883
  12920898339462005509241894496664114174864310382354528376447324098371972851406769355012519642620987800344947292567065096417424954859491203994089564380633918607074104635734055710723287000672505941498021021102939781353019376445744148511082]
 [30144408878990584963845888730430285546890923783558696532376019500104535208264912978274390355588776294189300336859817360042097089659133932451069519871203666301166149865362481490838691919298099907607970181061914483528961219682590869376305
  16319374402010300035126526280473992616184480231193928692106648148738176756952960045927807712594005563902521444141875023920883606233211188564403406891112811493835541616646210594132518707478985567832956045813942376827556474054184992262198
  65104524774191931734398664006666497104464985278975325749138408691063220717684263625079832312846802913032655911164309463838238433324194214432867380292477101336229147094783328829549375758527296970183]]
"""
